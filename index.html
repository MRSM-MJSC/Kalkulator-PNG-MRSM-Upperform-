<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MRSM PNG Calculator (Upper form)</title>
<link rel="icon" href="Icon.PNG" type="image/png">   
<style>
body {
    background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url("bg.JPG");
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    text-align: center;
    font-family: Arial, sans-serif;
    color: white;
}
h1 { margin-bottom: 5px; margin-top: 120px; }
.section { margin: 15px 0; }
label { display: block; margin: 8px 0 3px 0; font-weight: normal; }
input[type="text"], input[type="number"] { padding: 5px; width: 120px; text-align: center; font-size: 16px; height:12px; }
button { padding: 8px 16px; font-size: 16px; margin-top: 15px; cursor: pointer; }

#topBar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 90px;
    background: rgba(255,255,255,0.75);
    backdrop-filter: blur(8px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 999;
}
#logoGroup {
    position: fixed;
    top: 15px;
    left: 15px; 
    padding: 10px 20px;
    background: rgba(255,255,255,0.75);
    border-radius: 40px;
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    gap: 18px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}
#topbarTitle { 
    position: absolute;
    left: 49.2%;
    transform: translateX(-50%);
    font-weight: bold; 
    font-size: 30px; 
    color: #000; 
}

#menuContainer {
    position: absolute;
    top: 10px;    
    right: 50px;  
    display: flex;
    align-items: center;
}
#menuDropdown {
    display: none;
    position: absolute;
    right: 0;
    top: 40px;
    background: rgba(255,255,255,0.9);
    border-radius: 6px;
    padding: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    text-align: left;
    min-width: 150px;
    z-index: 1000;
}
#result, #message { margin-top:10px; font-size:18px; font-weight:bold; }


@media (max-width: 600px) {
    #topBar {
        height: 45px; 
        flex-direction: row; 
        justify-content: space-between;
        padding: 5px 10px;
    }

    #logoGroup {
        position: static;
        width: auto;
        padding: 5px 10px;
        gap: 8px;
        flex-shrink: 1;
        justify-content: flex-start;
    }

    #logoGroup img {
        height: 20px;    /* ikut tinggi topbar (fluid) */
        width: auto;    /* maintain ratio, TAK melebar */
    }

    #menuContainer {
        /*position: static;*/
        flex-shrink: 1;
        justify-content: flex-end;
        position: absolute;
        top: 0.5px;    
        right: 25px;  
        display: flex;
        align-items: center;
        margin: 0;
        padding: 0;
    }
    #menuContainer button {
        padding: 3px 6px;
        font-size: 12px;
    }

    body {
        margin-top: 55px;
    }

    input[type="text"], input[type="number"] { 
        width: 120px;
    }
    #markah {
        width: 120px !important;
        max-width: 120px;
    }

    #tutorialModal > div {
        width: 95% !important;
        max-width: 400px !important;
    }
}    
    
  
</style>
</head>
<body>

<div id="topBar">
    <div id="logoGroup">
        <img src="MRSM.png" style="height:38px;">
        <img src="IMG_1460.webp" style="height:33px;">
    </div>
    <div id="menuContainer">
        <button id="menuButton" style="
            padding: 8px 14px;
            background: rgba(255,255,255,0.6);
            border: none;
            border-radius: 6px;
            backdrop-filter: blur(6px);
            cursor: pointer;
            font-weight: normal;
        ">Menu â‹®</button>
        <div id="menuDropdown">
            <button onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSeJATuW1pIzKaQjklqg8FY0KBRCVHVKNHlX9sUPhS4mX-17Ag/viewform?usp=dialog','_blank')" style="display:block; width:100%; margin-bottom:5px;">Feedback ğŸ“</button>
            <button onclick="document.getElementById('tutorialModal').style.display='flex'" style="display:block; width:100%;">Tutorial ğŸ¥</button>
        </div>
    </div>
</div>


<h1>PNG Calculator</h1>

<div class="section">
<label>Exam:</label>
<input type="radio" id="formative-no" name="formative" value="Tidak" checked onclick="toggleExtraFields(false)"> Formative
<input type="radio" id="formative-yes" name="formative" value="Ya" onclick="toggleExtraFields(true)"> Semester
</div>

<div class="section">
<span>Your name:</span>
<input type="text" id="nama" style="height:12px;">
</div>

<div class="section">
<label for="melayu">Bahasa MelayuğŸ“š</label>
<input type="number" id="melayu" style="height:12px;">
<label for="inggeris">EnglishğŸ“–</label>
<input type="number" id="inggeris" style="height:12px;">
<label for="islam">Pendidikan IslamğŸ•Œ</label>
<input type="number" id="islam" style="height:12px;">
<label for="sej">SejarahğŸ“œ</label>
<input type="number" id="sej" style="height:12px;">
<label for="math">MathematicsğŸ§®</label>
<input type="number" id="math" style="height:12px;">
<label for="addmath">Additional MathematicsğŸ§®</label>
<input type="number" id="addmath" style="height:12px;">
<label for="phy">PhysicsğŸ”­</label>
<input type="number" id="phy" style="height:12px;">
<label for="chem">ChemistryğŸ§ª</label>
<input type="number" id="chem" style="height:12px;">
<label for="bio">BiologyğŸ§¬/Prinsip PerakaunanğŸ’µ</label>
<div class="section">
  <select id="subjek" onchange="updatePlaceholder()">
    <option value="" disabled selected>Pilih subjek</option>
    <option value="bio">Biologi</option>
    <option value="akaun">Prinsip Perakaunan</option>
  </select>
  <br><br>
  <input type="number" id="markah" placeholder="Fill in your mark" style="height:12px; width:250px">
</div>

<div id="extra-fields" style="display:none;">
    <label for="pj">Pendidikan Jasmani & Kesihatanâš½ï¸</label>
    <input type="number" id="pj" style="height:12px; width:120px;">
    <br><br>
    <label>Credit Hour for PJK:</label>
    <input type="radio" name="pjcredit" id="pj2" value="2" checked> 2
    <input type="radio" name="pjcredit" id="pj3" value="3"> 3 
</div>

<br>
<button onclick="calculatePNG(document.getElementById('formative-no').checked)">Calculate PNGğŸ”</button>

<center>
<p><small><small>'MJSC Tepen' product<br>Waldann, Azriff & Adlann</small></small></p>
<h3>Result:</h3>
<p id="result"></p>
<p id="message"></p>
</center>

<div id="tutorialModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); backdrop-filter: blur(3px); justify-content:center; align-items:center;">
<div style="background:white; padding:15px; border-radius:10px; width:90%; max-width:500px; text-align:center;">
<h3>User Tutorial</h3>
<video id="tutoVideo" width="100%" controls >
<source src="Tutorial.mp4" type="video/mp4">
</video>
<br><br>
<button id="closeTutorial" style="padding:7px 18px; background:#ff4f4f; border:none; border-radius:5px; color:white; cursor:pointer;">Close âœ–ï¸</button>
</div></div>

<script>
// Toggle PJ field
function toggleExtraFields(show) { 
    document.getElementById('extra-fields').style.display = show ? 'block' : 'none'; 
}

// Limit semua input number ke 0â€“100 & block huruf
document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', () => {
        input.value = input.value.replace(/[^0-9]/g, '');
        if(input.value > 100) input.value = 100;
        if(input.value < 0) input.value = 0;
    });
});

// Update placeholder untuk subjek
function updatePlaceholder(){
  const subjek = document.getElementById("subjek").value;
  const input = document.getElementById("markah");
  if(subjek === "bio"){ input.placeholder = "Biology"; input.disabled = false; }
  else if(subjek === "akaun"){ input.placeholder = "Akaun"; input.disabled = false; }
}

// Kalkulator PNG
function calculatePNG(isFormative) {
    let nama = document.getElementById("nama").value;
    let inputs = ["melayu","inggeris","math","addmath","phy","chem","markah","sej","islam"]; 
    if(!isFormative) inputs.push("pj");

    for(let id of inputs){
        let element = document.getElementById(id);
        if(element && element.value === "") {
            alert("Please fill in your marks before you can calculate your PNG!"); 
            return; 
        }
    }

    let melayu = parseFloat(document.getElementById("melayu").value);
    let inggeris = parseFloat(document.getElementById("inggeris").value);
    let math = parseFloat(document.getElementById("math").value);
    let addmath = parseFloat(document.getElementById("addmath").value);
    let phy = parseFloat(document.getElementById("phy").value);
    let chem = parseFloat(document.getElementById("chem").value);
    let bio = parseFloat(document.getElementById("markah").value);
    let sej = parseFloat(document.getElementById("sej").value);
    let islam = parseFloat(document.getElementById("islam").value);
    let pjMark = isFormative ? 0 : parseFloat(document.getElementById("pj").value);
    let pjCredit = isFormative ? 0 : parseInt(document.querySelector('input[name="pjcredit"]:checked').value);

    function gradeBM(score){if(score>=85)return 4;if(score>=80)return 3.67;if(score>=75)return 3.33;if(score>=70)return 3;if(score>=65)return 2.67;if(score>=60)return 2.33;if(score>=55)return 2;if(score>=50)return 1.67;if(score>=45)return 1.33;if(score>=40)return 1;return 0;}
    function gradeBI(score){if(score>=80)return 4;if(score>=75)return 3.67;if(score>=70)return 3.33;if(score>=65)return 3;if(score>=60)return 2.67;if(score>=55)return 2.33;if(score>=50)return 2;if(score>=45)return 1.67;if(score>=40)return 1.33;if(score>=35)return 1;return 0;}
    function gradeMath(score){return gradeBI(score);}
    function gradeAddMath(score){if(score>=75)return 4;if(score>=65)return 3.67;if(score>=60)return 3.33;if(score>=55)return 3;if(score>=50)return 2.67;if(score>=45)return 2.33;if(score>=40)return 2;if(score>=35)return 1.67;if(score>=30)return 1.33;if(score>=25)return 1;return 0;}
    function gradePhy(score){if(score>=75)return 4;if(score>=70)return 3.67;if(score>=65)return 3.33;if(score>=60)return 3;if(score>=55)return 2.67;if(score>=50)return 2.33;if(score>=45)return 2;if(score>=40)return 1.67;if(score>=35)return 1.33;if(score>=30)return 1;return 0;}
    function gradeChem(score){return gradePhy(score);}
    function gradeBio(score){return gradePhy(score);}
    function gradeAkaun(score){if(score >= 85) return 4;if(score >= 80) return 3.67;if(score >= 75) return 3.33;if(score >= 70) return 3;if(score >= 65) return 2.67;if(score >= 60) return 2.33;if(score >= 55) return 2;if(score >= 50) return 1.67;if(score >= 45) return 1.33;return 0;}
    function gradeSej(score){if(score>=85)return 4;if(score>=80)return 3.67;if(score>=75)return 3.33;if(score>=70)return 3;if(score>=65)return 2.67;if(score>=60)return 2.33;if(score>=55)return 2;if(score>=50)return 1.67;if(score>=45)return 1.33;if(score>=40)return 1;return 0;}
    function gradeIslam(score){return gradeSej(score);}
    function gradePJ(score){return gradeSej(score);}

    let Bm = gradeBM(melayu)*6;
    let Bi = gradeBI(inggeris)*6;
    let Mt = gradeMath(math)*6;
    let Admt = gradeAddMath(addmath)*6;
    let Sic = gradePhy(phy)*6;
    let Kim = gradeChem(chem)*6;
    let Sj = gradeSej(sej)*4;
    let Pi = gradeIslam(islam)*5;
    let subjekDipilih = document.getElementById("subjek").value;
    let Gy = subjekDipilih === "bio" ? gradeBio(bio)*6 : gradeAkaun(bio)*6;
    let Pe = isFormative ? 0 : gradePJ(pjMark) * pjCredit;

    let total = Bm+Bi+Mt+Admt+Sic+Kim+Gy+Sj+Pi+Pe;
    let purata = total / (51 + parseInt(pjCredit));
    document.getElementById("result").innerHTML = "PNG anda ialah: " + purata.toFixed(3);

    let message = "";
    if(purata===4){message="Congratulations "+nama+"!, You got a 4.00 flat this exam. Keep up the good work!";}
    else if(purata>=3.50){message="Congratulations "+nama+"!, Keep up your good work.";}
    else if(purata>=3){message="You have done your best, "+nama+"! Try again in the next exam.";}
    else{message="Don't give up, "+nama+". Study harder and you'll get better results.";}
    document.getElementById("message").innerHTML = message;

    // Google Form auto-submit
    const url = "https://docs.google.com/forms/d/e/1FAIpQLSeFtGBcFWNTQuCfbTunzeAWa4MdY7mUTkp01sUUYYGU_JUwMw/formResponse";
    const formData = new FormData();
    formData.append("entry.218510410", nama);
    formData.append("entry.1361796752", melayu);
    formData.append("entry.1742954856", inggeris);
    formData.append("entry.610405405", math);
    formData.append("entry.751682377", addmath);
    formData.append("entry.750948869", phy);
    formData.append("entry.644863431", chem);
    formData.append("entry.879483574", bio);
    formData.append("entry.1079830362", sej);
    formData.append("entry.401383712", islam);
    formData.append("entry.34491633", pjMark);
    formData.append("entry.1763271432", purata.toFixed(3));
    fetch(url, { method: "POST", mode: "no-cors", body: formData });
}

// Menu JS
const menuButton = document.getElementById("menuButton");
const menuDropdown = document.getElementById("menuDropdown");
menuButton.onclick = () => { menuDropdown.style.display = menuDropdown.style.display === "block" ? "none" : "block"; }
window.onclick = function(e) {
  if (!document.getElementById("menuContainer").contains(e.target)) {
    menuDropdown.style.display = "none";
  }
}

// Tutorial Modal JS
window.onload = () => { document.getElementById("tutorialModal").style.display = "flex"; }
document.getElementById("closeTutorial").onclick = () => {
    let video = document.getElementById("tutoVideo");
    video.pause(); video.currentTime = 0;
    document.getElementById("tutorialModal").style.display = "none";
}
</script>

</body>
</html>
